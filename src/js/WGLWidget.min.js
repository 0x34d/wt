WT_DECLARE_WT_MEMBER(1,"WGLWidget",function(p,j){jQuery.data(j,"obj",this);var h=p.WT;this.ctx=null;this.initializeGL=function(){};this.paintGL=function(){};var f=null,g=null,k=null,l=0,m=0,c=null,n=0,o=0;this.discoverContext=function(){if(j.getContext){this.ctx=j.getContext("experimental-webgl");if(this.ctx==null)this.ctx=j.getContext("webgl");this.ctx==null&&console.log("WGLWidget: failed to get a webgl context")}console.log("ctx: "+this.ctx);return this.ctx};this.setLookAtParams=function(a,b,d,
e,i){c=a;g=b;k=d;l=e;m=i};this.mouseDragLookAt=function(a,b){var d=h.pageCoordinates(b);a=d.x-f.x;d=d.y-f.y;var e=vec3.create();e[0]=c[0];e[1]=c[4];e[2]=c[8];var i=mat4.create();mat4.identity(i);mat4.translate(i,g);mat4.rotate(i,d*l,e);mat4.rotate(i,a*m,k);vec3.negate(g);mat4.translate(i,g);vec3.negate(g);mat4.multiply(c,i,c);console.log("mouseDragLookAt after: "+mat4.str(c));console.log("mouseDragLookAt: repaint");this.paintGl();f=h.pageCoordinates(b)};this.mouseWheelLookAt=function(a,b){a=h.wheelDelta(b);
b=Math.pow(1.2,a);console.log("mouseWheelLookAt: "+a);mat4.translate(c,g);mat4.scale(c,[b,b,b]);vec3.negate(g);mat4.translate(c,g);vec3.negate(g);console.log("mouseWheelLookAt: repaint");this.paintGl()};this.setWalkParams=function(a,b,d){c=a;n=b;o=d};this.mouseDragWalk=function(a,b){var d=h.pageCoordinates(b);a=d.x-f.x;d=d.y-f.y;var e=mat4.create();mat4.identity(e);mat4.rotateY(e,a*o);a=vec3.create();a[0]=0;a[1]=0;a[2]=-n*d;mat4.translate(e,a);mat4.multiply(e,c,c);this.paintGl();f=h.pageCoordinates(b)};
this.mouseDown=function(a,b){h.capture(null);h.capture(j);f=h.pageCoordinates(b)};this.mouseUp=function(){if(f!=null)f=null}});
