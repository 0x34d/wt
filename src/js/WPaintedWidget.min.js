WT_DECLARE_WT_MEMBER(10,JavaScriptConstructor,"WPaintedWidget",(function(t,r){r.wtObj=this;var e=this;this.imagePreloaders=[];this.images=[];this.canvas=document.getElementById("c"+r.id);this.repaint=function(){};this.widget=r;this.cancelPreloaders=function(){for(var t=0;t<e.imagePreloaders.length;++t)e.imagePreloaders[t].cancel();e.imagePreloaders=[]}}));WT_DECLARE_WT_MEMBER(11,JavaScriptObject,"gfxUtils",function(){var t=1024,r=4080;return new function(){var e=this;this.path_crisp=function(t){return t.map((function(t){return[Math.floor(t[0])+.5,Math.floor(t[1])+.5,t[2]]}))};this.transform_mult=function(t,r){if(2===r.length){var n=r[0],a=r[1];return[t[0]*n+t[2]*a+t[4],t[1]*n+t[3]*a+t[5]]}if(3===r.length){if(8===r[2]||9===r[2])return r.slice(0);n=r[0],a=r[1];return[t[0]*n+t[2]*a+t[4],t[1]*n+t[3]*a+t[5],r[2]]}if(4===r.length){var i,o,s,c,f,l,u=e.transform_mult(t,[r[0],r[1]]);i=u[0];s=u[0];o=u[1];c=u[1];for(f=0;f<3;++f){l=e.transform_mult(t,0==f?[e.rect_left(r),e.rect_bottom(r)]:1==f?[e.rect_right(r),e.rect_top(r)]:[e.rect_right(r),e.rect_bottom(r)]);i=Math.min(i,l[0]);s=Math.max(s,l[0]);o=Math.min(o,l[1]);c=Math.max(c,l[1])}return[i,o,s-i,c-o]}return 6===r.length?[t[0]*r[0]+t[2]*r[1],t[1]*r[0]+t[3]*r[1],t[0]*r[2]+t[2]*r[3],t[1]*r[2]+t[3]*r[3],t[0]*r[4]+t[2]*r[5]+t[4],t[1]*r[4]+t[3]*r[5]+t[5]]:[]};this.transform_apply=function(t,r){var n=e.transform_mult;return r.map((function(r){return n(t,r)}))};this.transform_det=function(t){var r=t[0],e=t[2],n=t[1];return r*t[3]-n*e};this.transform_adjoint=function(t){var r=t[0],e=t[2],n=t[1],a=t[3],i=t[4],o=t[5];return[a,-e,-n,r,o*n-i*a,-(o*r-i*e)]};this.transform_inverted=function(t){var r=e.transform_det(t);if(0!=r){var n=e.transform_adjoint(t);return[n[0]/r,n[2]/r,n[1]/r,n[3]/r,n[4]/r,n[5]/r]}console.log("inverted(): oops, determinant == 0");return t};this.transform_assign=function(t,r){t[0]=r[0];t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4];t[5]=r[5]};this.transform_equal=function(t,r){return t[0]==r[0]&&t[1]==r[1]&&t[2]==r[2]&&t[3]==r[3]&&t[4]==r[4]&&t[5]==r[5]};this.css_text=function(t){return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"};this.arcPosition=function(t,r,e,n,a){var i=-a/180*Math.PI;return[t+e*Math.cos(i),r+n*Math.sin(i)]};this.pnpoly=function(t,r){var n,a,i,o=!1,s=0,c=0,f=t[0],l=t[1];for(n=0;n<r.length;++n){a=s;i=c;if(7===r[n][2]){a=(u=e.arcPosition(r[n][0],r[n][1],r[n+1][0],r[n+1][1],r[n+2][0]))[0];i=u[1]}else if(9===r[n][2]){var u;a=(u=e.arcPosition(r[n-2][0],r[n-2][1],r[n-1][0],r[n-1][1],r[n][0]+r[n][1]))[0];i=u[1]}else if(8!==r[n][2]){a=r[n][0];i=r[n][1]}0!==r[n][2]&&c>l!=i>l&&f<(a-s)*(l-c)/(i-c)+s&&(o=!o);s=a;c=i}return o};this.rect_intersection=function(t,r){t=e.rect_normalized(t);r=e.rect_normalized(r);var n=e.rect_top,a=e.rect_bottom,i=e.rect_left,o=e.rect_right,s=Math.max(i(t),i(r)),c=Math.min(o(t),o(r)),f=Math.max(n(t),n(r));return[s,f,c-s,Math.min(a(t),a(r))-f]};this.drawRect=function(t,r,n,a){r=e.rect_normalized(r);var i=e.rect_top(r),o=e.rect_bottom(r),s=e.rect_left(r),c=e.rect_right(r);path=[[s,i,0],[c,i,1],[c,o,1],[s,o,1],[s,i,1]];e.drawPath(t,path,n,a,!1)};this.drawPath=function(t,r,n,a,i){var o=0,s=[],c=[],f=[],l=1048576;function u(t){return t[0]}function h(t){return t[1]}function m(t){return t[2]}t.beginPath();r.length>0&&0!==m(r[0])&&t.moveTo(0,0);for(o=0;o<r.length;o++){var p=r[o];switch(m(p)){case 0:Math.abs(u(p))<=l&&Math.abs(h(p))<=l&&t.moveTo(u(p),h(p));break;case 1:!function(){var s=0===o?[0,0]:r[o-1];if(!n&&!i&&a&&(Math.abs(u(s))>l||Math.abs(h(s))>l||Math.abs(u(p))>l||Math.abs(h(p))>l)){!function(){var r,n=t.wtTransform?t.wtTransform:[1,0,0,1,0,0],a=e.transform_inverted(n),i=e.transform_mult(n,s),o=e.transform_mult(n,p),c=u(o)-u(i),f=h(o)-h(i),l=-50,m=t.canvas.width+50,_=-50,v=t.canvas.height+50;function g(t,r,e){return(e-t)/r}function d(t,r,e){return t+e*r}var b,w,P=null,M=null,T=null,y=null;if(u(i)<l&&u(o)>l){r=g(u(i),c,l);P=[l,d(h(i),f,r),r]}else if(u(i)>m&&u(o)<m){r=g(u(i),c,m);P=[m,d(h(i),f,r),r]}else{if(!(u(i)>l&&u(i)<m))return;P=[u(i),h(i),0]}if(h(i)<_&&h(o)>_){r=g(h(i),f,_);M=[d(u(i),c,r),_,r]}else if(h(i)>v&&h(o)<v){r=g(h(i),f,v);M=[d(u(i),c,r),v,r]}else{if(!(h(i)>_&&h(i)<v))return;M=[u(i),h(i),0]}if(!(u(b=P[2]>M[2]?[P[0],P[1]]:[M[0],M[1]])<l||u(b)>m||h(b)<_||h(b)>v)){if(u(i)<m&&u(o)>m){r=g(u(i),c,m);T=[m,d(h(i),f,r),r]}else if(u(i)>l&&u(o)<l){r=g(u(i),c,l);T=[l,d(h(i),f,r),r]}else{if(!(u(o)>l&&u(o)<m))return;T=[u(o),h(o),1]}if(h(i)<v&&h(o)>v){r=g(h(i),f,v);y=[d(u(i),c,r),v,r]}else if(h(i)>_&&h(o)<_){r=g(h(i),f,_);y=[d(u(i),c,r),_,r]}else{if(!(u(o)>_&&h(o)<v))return;y=[u(o),h(o),1]}if(!(u(w=T[2]<y[2]?[T[0],T[1]]:[y[0],y[1]])<l||u(w)>m||h(w)<_||h(w)>v)){b=e.transform_mult(a,b);w=e.transform_mult(a,w);t.moveTo(b[0],b[1]);t.lineTo(w[0],w[1])}}}();Math.abs(u(p))<=l&&Math.abs(h(p))<=l&&t.moveTo(u(p),h(p))}else t.lineTo(u(p),h(p))}();break;case 2:case 3:s.push(u(p),h(p));break;case 4:s.push(u(p),h(p));t.bezierCurveTo.apply(t,s);s=[];break;case 7:c.push(u(p),h(p));break;case 8:c.push(u(p));break;case 9:!function(){function r(t){var r=t%360;return r<0?r+360:r}function e(t){return t*Math.PI/180}var n,a,i=u(p),o=h(p),s=e(r(-i));n=o>=360||o<=-360?s-2*Math.PI*(o>0?1:-1):e(r(-i-((a=o)>360?360:a<-360?-360:a)));var f=o>0;c.push(s,n,f);t.arc.apply(t,c);c=[]}();break;case 5:f.push(u(p),h(p));break;case 6:f.push(u(p),h(p));t.quadraticCurveTo.apply(t,f);f=[]}}n&&t.fill();a&&t.stroke();i&&t.clip()};this.drawStencilAlongPath=function(t,r,n,a,i,o){var s,c=0;function f(t){return t[1]}function l(t){return t[2]}for(c=0;c<n.length;c++){var u=n[c];if((!o||!t.wtClipPath||e.pnpoly(u,e.transform_apply(t.wtClipPathTransform,t.wtClipPath)))&&(0==l(u)||1==l(u)||6==l(u)||4==l(u))){var h=e.transform_apply([1,0,0,1,(s=u,s[0]),f(u)],r);e.drawPath(t,h,a,i,!1)}}};this.drawText=function(n,a,i,o,s){if(!s||!n.wtClipPath||e.pnpoly(s,e.transform_apply(n.wtClipPathTransform,n.wtClipPath))){var c=i&r,f=null,l=null;switch(15&i){case 1:n.textAlign="left";f=e.rect_left(a);break;case 2:n.textAlign="right";f=e.rect_right(a);break;case 4:n.textAlign="center";f=e.rect_center(a).x}switch(c){case 128:n.textBaseline="top";l=e.rect_top(a);break;case t:n.textBaseline="bottom";l=e.rect_bottom(a);break;case 512:n.textBaseline="middle";l=e.rect_center(a).y}if(null!=f&&null!=l){var u=n.fillStyle;n.fillStyle=n.strokeStyle;n.fillText(o,f,l);n.fillStyle=u}}};this.calcYOffset=function(r,e,n,a){return 512===a?-(e-1)*n/2+r*n:128===a?r*n:a===t?-(e-1-r)*n:0};this.drawTextOnPath=function(t,n,a,i,o,s,c,f,l){var u=0,h=0;function m(t){return t[0]}function p(t){return t[1]}function _(t){return t[2]}var v=e.transform_apply(i,o);for(u=0;u<o.length&&!(u>=n.length);u++){var g=o[u],d=v[u],b=n[u].split("\n");if(0==_(g)||1==_(g)||6==_(g)||4==_(g))if(0==s)for(h=0;h<b.length;h++){var w=e.calcYOffset(h,b.length,c,f&r);e.drawText(t,[a[0]+m(d),a[1]+p(d)+w,a[2],a[3]],f,b[h],l?[m(d),p(d)]:null)}else{var P=s*Math.PI/180,M=Math.cos(-P),T=-Math.sin(-P),y=-T,x=M;t.save();t.transform(M,y,T,x,m(d),p(d));for(h=0;h<b.length;h++){w=e.calcYOffset(h,b.length,c,f&r);e.drawText(t,[a[0],a[1]+w,a[2],a[3]],f,b[h],l?[m(d),p(d)]:null)}t.restore()}}};this.setClipPath=function(t,r,n,a){if(a){t.setTransform.apply(t,n);e.drawPath(t,r,!1,!1,!0);t.setTransform(1,0,0,1,0,0)}t.wtClipPath=r;t.wtClipPathTransform=n};this.removeClipPath=function(t){delete t.wtClipPath;delete t.wtClipPathTransform};this.rect_top=function(t){return t[1]};this.rect_bottom=function(t){return t[1]+t[3]};this.rect_right=function(t){return t[0]+t[2]};this.rect_left=function(t){return t[0]};this.rect_topleft=function(t){return[t[0],t[1]]};this.rect_topright=function(t){return[t[0]+t[2],t[1]]};this.rect_bottomleft=function(t){return[t[0],t[1]+t[3]]};this.rect_bottomright=function(t){return[t[0]+t[2],t[1]+t[3]]};this.rect_center=function(t){return{x:(2*t[0]+t[2])/2,y:(2*t[1]+t[3])/2}};this.rect_normalized=function(t){var r,e,n,a;if(t[2]>0){r=t[0];n=t[2]}else{r=t[0]+t[2];n=-t[2]}if(t[3]>0){e=t[1];a=t[3]}else{e=t[1]+t[3];a=-t[3]}return[r,e,n,a]};this.drawImage=function(t,r,e,n,a){try{t.drawImage(r,n[0],n[1],n[2],n[3],a[0],a[1],a[2],a[3])}catch(t){var i="Error while drawing image: '"+e+"': "+t.name;t.message&&(i+=": "+t.message);console.error(i)}}}}());