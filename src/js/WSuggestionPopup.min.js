WT_DECLARE_WT_MEMBER(1,"WSuggestionPopup",function(o,e,v,w,l){function p(){return e.style.display!="none"}function k(){e.style.display="none"}function x(b){f.positionAtWidget(e.id,b.id,f.Vertical)}function y(b){b=b.target||b.srcElement;if(b.className!="content"){if(!f.hasTag(b,"DIV"))b=b.parentNode;q(b)}}function q(b){var a=b.firstChild;b=f.getElement(m);var g=a.innerHTML;a=a.getAttribute("sug");b.focus();v(b,g,a);k()}jQuery.data(e,"obj",this);var n=this,f=o.WT,i=null,m=null,r=false,s=null,t=null;
this.showPopup=function(){e.style.display="";i=null};this.editKeyDown=function(b,a){m=b.id;var g=i?f.getElement(i):null;if(p()&&g)if(a.keyCode==13||a.keyCode==9){q(g);f.cancelEvent(a);setTimeout(function(){b.focus()},0);return false}else if(a.keyCode==40||a.keyCode==38||a.keyCode==34||a.keyCode==33){if(a.type.toUpperCase()=="KEYDOWN"){r=true;f.cancelEvent(a,f.CancelDefaultAction)}if(a.type.toUpperCase()=="KEYPRESS"&&r==true){f.cancelEvent(a);return false}var c=g,h=g,j=a.keyCode==40||a.keyCode==34;
a=a.keyCode==34||a.keyCode==33?e.clientHeight/g.offsetHeight:1;var d;for(d=0;c&&d<a;++d){for(c=j?c.nextSibling:c.previousSibling;c&&c.nodeName.toUpperCase()=="DIV"&&c.style.display=="none";c=j?c.nextSibling:c.previousSibling)h=c;h=c||h}if(h&&h.nodeName.toUpperCase()=="DIV"){g.className=null;h.className="sel";i=h.id}return false}return a.keyCode!=13&&a.keyCode!=9};this.filtered=function(b){s=b;n.refilter()};this.refilter=function(){var b=i?f.getElement(i):null,a=f.getElement(m),g=w(a);if(l){var c=
g(null);if(c.length<l){k();return}else{c=c.substring(0,l);if(c!=s){k();if(c!=t){t=c;o.emit(e,"filter",c)}return}}}c=null;for(var h=e.lastChild.childNodes,j=0;j<h.length;j++){var d=h[j];if(d.nodeName.toUpperCase()=="DIV"){if(d.orig==null)d.orig=d.firstChild.innerHTML;else d.firstChild.innerHTML=d.orig;var u=g(d.firstChild.innerHTML);d.firstChild.innerHTML=u.suggestion;if(u.match){d.style.display="";if(c==null)c=d}else d.style.display="none";d.className=null}}if(c==null)k();else{if(!p()){x(a);n.showPopup();
b=null}if(!b||b.style.display=="none"){i=c.id;b=c;b.parentNode.scrollTop=0}b.className="sel";a=b.parentNode;if(b.offsetTop+b.offsetHeight>a.scrollTop+a.clientHeight)b.scrollIntoView(false);else b.offsetTop<a.scrollTop&&b.scrollIntoView(true)}};this.editKeyUp=function(b,a){if(!((a.keyCode==13||a.keyCode==9)&&e.style.display=="none"))if(a.keyCode==27||a.keyCode==37||a.keyCode==39){e.style.display="none";a.keyCode==27&&b.blur()}else n.refilter()};e.lastChild.onclick=y;this.delayHide=function(){setTimeout(function(){e&&
k()},300)}});
