WT_DECLARE_WT_MEMBER(1,"WSuggestionPopup",function(q,d,w,x,p){function r(){return d.style.display!="none"}function m(){d.style.display="none"}function y(a){c.positionAtWidget(d.id,a.id,c.Vertical)}function z(a){a=a||window.event;a=a.target||a.srcElement;if(a.className!="content"){if(!c.hasTag(a,"DIV"))a=a.parentNode;s(a)}}function s(a){var b=a.firstChild;a=c.getElement(h);var i=b.innerHTML;b=b.getAttribute("sug");a.focus();w(a,i,b);m();h=null}function A(a,b){for(a=b?a.nextSibling:a.previousSibling;a;a=
b?a.nextSibling:a.previousSibling)if(c.hasTag(a,"DIV"))if(a.style.display!="none")return a;return null}document.body.appendChild(d);jQuery.data(d,"obj",this);var o=this,c=q.WT,l=null,h=null,t=false,u=null,v=null;this.showPopup=function(){d.style.display="";l=null};this.editMouseMove=function(a,b){a.style.cursor=c.widgetCoordinates(a,b).x>a.offsetWidth-16?"default":""};this.editClick=function(a,b){if(b.clientX>a.offsetWidth-16){h=a.id;o.refilter()}};this.editKeyDown=function(a,b){if(h!=a.id)if($(a).hasClass("Wt-suggest-onedit"))h=
a.id;else if($(a).hasClass("Wt-suggest-dropdown")&&b.keyCode==40)h=a.id;else{h=null;return}var i=l?c.getElement(l):null;if(r()&&i)if(b.keyCode==13||b.keyCode==9){s(i);c.cancelEvent(b);setTimeout(function(){a.focus()},0);return false}else if(b.keyCode==40||b.keyCode==38||b.keyCode==34||b.keyCode==33){if(b.type.toUpperCase()=="KEYDOWN"){t=true;c.cancelEvent(b,c.CancelDefaultAction)}if(b.type.toUpperCase()=="KEYPRESS"&&t==true){c.cancelEvent(b);return false}var e=i,j=b.keyCode==40||b.keyCode==34;b=b.keyCode==
34||b.keyCode==33?d.clientHeight/i.offsetHeight:1;var g;for(g=0;e&&g<b;++g){var k=A(e,j);if(!k)break;e=k}if(e&&c.hasTag(e,"DIV")){i.className=null;e.className="sel";l=e.id}return false}return b.keyCode!=13&&b.keyCode!=9};this.filtered=function(a){u=a;o.refilter()};this.refilter=function(){var a=l?c.getElement(l):null,b=c.getElement(h),i=x(b),e=!$(b).hasClass("Wt-suggest-dropdown"),j=d.lastChild.childNodes,g=i(null);if(p)if(e&&g.length<p){m();return}else{j=g.substring(0,p);if(j!=u){if(j!=v){v=j;q.emit(d,
"filter",j)}if(e){m();return}}}var k=null;j=d.lastChild.childNodes;e=!e&&g.length==0;for(g=0;g<j.length;g++){var f=j[g];if(c.hasTag(f,"DIV")){if(f.orig==null)f.orig=f.firstChild.innerHTML;else f.firstChild.innerHTML=f.orig;var n=e;if(!e){n=i(f.firstChild.innerHTML);f.firstChild.innerHTML=n.suggestion;n=n.match}if(n){f.style.display="";if(k==null)k=f}else f.style.display="none";f.className=null}}if(k==null)m();else{if(!r()){y(b);o.showPopup();a=null}if(!a||a.style.display=="none"){l=k.id;a=k;a.parentNode.scrollTop=
0}a.className="sel";b=a.parentNode;if(a.offsetTop+a.offsetHeight>b.scrollTop+b.clientHeight)a.scrollIntoView(false);else a.offsetTop<b.scrollTop&&a.scrollIntoView(true)}};this.editKeyUp=function(a,b){if(h!=null)if(!((b.keyCode==13||b.keyCode==9)&&d.style.display=="none"))if(b.keyCode==27||b.keyCode==37||b.keyCode==39){d.style.display="none";if(b.keyCode==27){h=null;a.blur()}}else o.refilter()};d.lastChild.onclick=z;this.delayHide=function(){setTimeout(function(){d&&m()},300)}});
