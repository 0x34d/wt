WT_DECLARE_WT_MEMBER(1,"WSuggestionPopup",function(v,e,y,A,t){function o(a){return $(a).hasClass("Wt-suggest-onedit")||$(a).hasClass("Wt-suggest-dropdown")}function w(){return e.style.display!="none"}function c(){e.style.display="none"}function f(a){d.positionAtWidget(e.id,a.id,d.Vertical)}function j(a){a=a||window.event;a=a.target||a.srcElement;if(a.className!="content"){for(;a&&!d.hasTag(a,"DIV");)a=a.parentNode;a&&m(a)}}function m(a){var b=a.firstChild,k=d.getElement(g),l=b.innerHTML;b=b.getAttribute("sug");
k.focus();v.emit(e,"select",a.id,k.id);y(k,l,b);c();g=null}function p(a,b){for(a=b?a.nextSibling:a.previousSibling;a;a=b?a.nextSibling:a.previousSibling)if(d.hasTag(a,"DIV"))if(a.style.display!="none")return a;return null}function x(a){var b=a.parentNode;if(a.offsetTop+a.offsetHeight>b.scrollTop+b.clientHeight)b.scrollTop=a.offsetTop+a.offsetHeight-b.clientHeight;else if(a.offsetTop<b.scrollTop)b.scrollTop=a.offsetTop}$(".Wt-domRoot").add(e);jQuery.data(e,"obj",this);var q=this,d=v.WT,n=null,g=null,
D=false,E=null,F=null,z=null,B=null,u=false;this.showPopup=function(){e.style.display="";B=n=null};this.editMouseMove=function(a,b){if(o(a))a.style.cursor=d.widgetCoordinates(a,b).x>a.offsetWidth-16?"default":""};this.editClick=function(a,b){if(o(a))if(d.widgetCoordinates(a,b).x>a.offsetWidth-16)if(g!=a.id){c();g=a.id;u=true;q.refilter()}else{g=null;c()}};this.editKeyDown=function(a,b){if(!o(a))return true;if(g!=a.id)if($(a).hasClass("Wt-suggest-onedit")){g=a.id;u=false}else if($(a).hasClass("Wt-suggest-dropdown")&&
b.keyCode==40){g=a.id;u=true}else{g=null;return true}var k=n?d.getElement(n):null;if(w()&&k)if(b.keyCode==13||b.keyCode==9){m(k);d.cancelEvent(b);setTimeout(function(){a.focus()},0);return false}else if(b.keyCode==40||b.keyCode==38||b.keyCode==34||b.keyCode==33){if(b.type.toUpperCase()=="KEYDOWN"){D=true;d.cancelEvent(b,d.CancelDefaultAction)}if(b.type.toUpperCase()=="KEYPRESS"&&D==true){d.cancelEvent(b);return false}var l=k,r=b.keyCode==40||b.keyCode==34;b=b.keyCode==34||b.keyCode==33?e.clientHeight/
k.offsetHeight:1;var h;for(h=0;l&&h<b;++h){var s=p(l,r);if(!s)break;l=s}if(l&&d.hasTag(l,"DIV")){k.className="";l.className="sel";n=l.id}return false}return b.keyCode!=13&&b.keyCode!=9};this.filtered=function(a){E=a;q.refilter()};this.refilter=function(){var a=n?d.getElement(n):null,b=d.getElement(g),k=A(b),l=e.lastChild.childNodes,r=k(null);B=b.value;if(t)if(r.length<t&&!u){c();return}else{var h=r.substring(0,t);if(h!=E){if(h!=F){F=h;v.emit(e,"filter",h)}if(!u){c();return}}}h=null;r=u&&r.length==
0;var s,G;s=0;for(G=l.length;s<G;++s){var i=l[s];if(d.hasTag(i,"DIV")){if(i.orig==null)i.orig=i.firstChild.innerHTML;var C=k(i.orig),H=r||C.match;if(C.suggestion!=i.firstChild.innerHTML)i.firstChild.innerHTML=C.suggestion;if(H){if(i.style.display!="")i.style.display="";if(h==null)h=i}else if(i.style.display!="none")i.style.display="none";if(i.className!="")i.className=""}}if(h==null)c();else{if(!w()){f(b);q.showPopup();a=null}if(!a||a.style.display=="none"){n=h.id;a=h;a.parentNode.scrollTop=0}a.className=
"sel";x(a)}};this.editKeyUp=function(a,b){if(g!=null)if(o(a))if(!((b.keyCode==13||b.keyCode==9)&&e.style.display=="none"))if(b.keyCode==27||b.keyCode==37||b.keyCode==39){e.style.display="none";if(b.keyCode==27){g=null;$(a).hasClass("Wt-suggest-dropdown")?c():a.blur()}}else if(a.value!=B)q.refilter();else(a=n?d.getElement(n):null)&&x(a)};e.lastChild.onclick=j;e.lastChild.onscroll=function(){if(z){clearTimeout(z);var a=d.getElement(g);a&&a.focus()}};this.delayHide=function(a){z=setTimeout(function(){z=
null;if(e&&(a==null||g==a.id))c()},300)}});
WT_DECLARE_WT_MEMBER(2,"WSuggestionPopupStdMatcher",function(v,e,y,A,t,o){function w(c){var f=c.value;c=c.selectionStart?c.selectionStart:f.length;for(var j=y?f.lastIndexOf(y,c-1)+1:0;j<c&&A.indexOf(f.charAt(j))!=-1;)++j;return{start:j,end:c}}this.match=function(c){var f=w(c),j=c.value.substring(f.start,f.end),m="^";if(t.length!=0)m="(^|(?:["+t+"]))";m+="("+j.replace(new RegExp("([\\^\\\\\\][\\-.$*+?()|{}])","g"),"\\$1")+")";m=new RegExp(m,"gi");return function(p){if(!p)return j;var x=false;if(j.length){var q=
p.replace(m,"$1"+v+"$2"+e);if(q!=p){x=true;p=q}}return{match:x,suggestion:p}}};this.replace=function(c,f,j){f=w(c);var m=c.value.substring(0,f.start)+j+o;if(f.end<c.value.length)m+=c.value.substring(f.end,c.value.length);c.value=m;if(c.selectionStart){c.selectionStart=f.start+j.length+o.length;c.selectionEnd=c.selectionStart}}});
