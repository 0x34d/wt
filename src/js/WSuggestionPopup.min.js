WT_DECLARE_WT_MEMBER(1,"WSuggestionPopup",function(q,d,x,y,p){function r(){return d.style.display!="none"}function k(){d.style.display="none"}function z(a){c.positionAtWidget(d.id,a.id,c.Vertical)}function A(a){a=a||window.event;a=a.target||a.srcElement;if(a.className!="content"){if(!c.hasTag(a,"DIV"))a=a.parentNode;s(a)}}function s(a){var b=a.firstChild;a=c.getElement(e);var i=b.innerHTML;b=b.getAttribute("sug");a.focus();x(a,i,b);k();e=null}function B(a,b){for(a=b?a.nextSibling:a.previousSibling;a;a=
b?a.nextSibling:a.previousSibling)if(c.hasTag(a,"DIV"))if(a.style.display!="none")return a;return null}document.body.appendChild(d);jQuery.data(d,"obj",this);var n=this,c=q.WT,m=null,e=null,t=false,u=null,v=null,o=null;this.showPopup=function(){d.style.display="";m=null};this.editMouseMove=function(a,b){a.style.cursor=c.widgetCoordinates(a,b).x>a.offsetWidth-16?"default":""};this.editClick=function(a,b){if(c.widgetCoordinates(a,b).x>a.offsetWidth-16)if(e!=a.id){k();e=a.id;n.refilter()}else{e=null;
k()}};this.editKeyDown=function(a,b){if(e!=a.id)if($(a).hasClass("Wt-suggest-onedit"))e=a.id;else if($(a).hasClass("Wt-suggest-dropdown")&&b.keyCode==40)e=a.id;else{e=null;return true}var i=m?c.getElement(m):null;if(r()&&i)if(b.keyCode==13||b.keyCode==9){s(i);c.cancelEvent(b);setTimeout(function(){a.focus()},0);return false}else if(b.keyCode==40||b.keyCode==38||b.keyCode==34||b.keyCode==33){if(b.type.toUpperCase()=="KEYDOWN"){t=true;c.cancelEvent(b,c.CancelDefaultAction)}if(b.type.toUpperCase()==
"KEYPRESS"&&t==true){c.cancelEvent(b);return false}var f=i,j=b.keyCode==40||b.keyCode==34;b=b.keyCode==34||b.keyCode==33?d.clientHeight/i.offsetHeight:1;var h;for(h=0;f&&h<b;++h){var l=B(f,j);if(!l)break;f=l}if(f&&c.hasTag(f,"DIV")){i.className=null;f.className="sel";m=f.id}return false}return b.keyCode!=13&&b.keyCode!=9};this.filtered=function(a){u=a;n.refilter()};this.refilter=function(){var a=m?c.getElement(m):null,b=c.getElement(e),i=y(b),f=!$(b).hasClass("Wt-suggest-dropdown"),j=d.lastChild.childNodes,
h=i(null);if(p)if(f&&h.length<p){k();return}else{j=h.substring(0,p);if(j!=u){if(j!=v){v=j;q.emit(d,"filter",j)}if(f){k();return}}}var l=null;j=d.lastChild.childNodes;f=!f&&h.length==0;for(h=0;h<j.length;h++){var g=j[h];if(c.hasTag(g,"DIV")){if(g.orig==null)g.orig=g.firstChild.innerHTML;else g.firstChild.innerHTML=g.orig;var w=i(g.firstChild.innerHTML),C=f||w.match;g.firstChild.innerHTML=w.suggestion;if(C){g.style.display="";if(l==null)l=g}else g.style.display="none";g.className=null}}if(l==null)k();
else{if(!r()){z(b);n.showPopup();a=null}if(!a||a.style.display=="none"){m=l.id;a=l;a.parentNode.scrollTop=0}a.className="sel";b=a.parentNode;if(a.offsetTop+a.offsetHeight>b.scrollTop+b.clientHeight)b.scrollTop=a.offsetTop+a.offsetHeight-b.clientHeight;else if(a.offsetTop<b.scrollTop)b.scrollTop=a.offsetTop}};this.editKeyUp=function(a,b){if(e!=null)if(!((b.keyCode==13||b.keyCode==9)&&d.style.display=="none"))if(b.keyCode==27||b.keyCode==37||b.keyCode==39){d.style.display="none";if(b.keyCode==27){e=
null;$(a).hasClass("Wt-suggest-dropdown")?k():a.blur()}}else n.refilter()};d.lastChild.onclick=A;d.lastChild.onscroll=function(){if(o){clearTimeout(o);var a=c.getElement(e);a&&a.focus()}};this.delayHide=function(a){o=setTimeout(function(){o=null;if(d&&(a==null||e==a.id))k()},300)}});
