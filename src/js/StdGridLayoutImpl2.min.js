WT_DECLARE_WT_MEMBER(1,JavaScriptConstructor,"StdLayout2",function(B,D,J,M,R,K,t,F,A,x,y){function E(a,b){var c=r[b],h=b?a.scrollHeight:a.scrollWidth,g=b?a.clientHeight:a.clientWidth;b=b?a.offsetHeight:a.offsetWidth;if(g>=1E6)g-=1E6;if(h>=1E6)h-=1E6;if(b>=1E6)b-=1E6;if(h===0)h=f.pxself(a,c.size);if(f.isIE&&(f.hasTag(a,"BUTTON")||f.hasTag(a,"TEXTAREA")||f.hasTag(a,"INPUT")||f.hasTag(a,"SELECT")))h=g;if(h>b)if(f.pxself(a,c.size)==0)h=0;else{var l=false;$(a).find(".Wt-popup").each(function(){if(this.style.display!=
"none")l=true});if(l)h=0}f.isOpera||(h+=f.px(a,"border"+c.Left+"Width")+f.px(a,"border"+c.Right+"Width"));h+=f.px(a,"margin"+c.Left)+f.px(a,"margin"+c.Right);if(!f.boxSizing(a)&&!f.isIE)h+=f.px(a,"padding"+c.Left)+f.px(a,"padding"+c.Right);if(h<b)h=b;a=f.px(a,"max"+c.Size);if(a>0)h=Math.min(a,h);return Math.round(h)}function w(a,b){b=r[b];if(a.style.display=="none")return 0;else if(a["layoutMin"+b.Size])return a["layoutMin"+b.Size];else{var c=f.px(a,"min"+b.Size);f.boxSizing(a)||(c+=f.px(a,"padding"+
b.Left)+f.px(a,"padding"+b.Right));return c}}function G(a,b){b=r[b];var c=f.px(a,"margin"+b.Left)+f.px(a,"margin"+b.Right);if(!f.boxSizing(a)&&!(f.isIE&&!f.isIElt9&&f.hasTag(a,"BUTTON")))c+=f.px(a,"border"+b.Left+"Width")+f.px(a,"border"+b.Right+"Width")+f.px(a,"padding"+b.Left)+f.px(a,"padding"+b.Right);return c}function I(a,b){b=r[b];return f.px(a,"padding"+b.Left)+f.px(a,"padding"+b.Right)}function V(a,b){if(f.boxSizing(a)){b=r[b];return f.px(a,"border"+b.Left+"Width")+f.px(a,"border"+b.Right+
"Width")+f.px(a,"padding"+b.Left)+f.px(a,"padding"+b.Right)}else return 0}function S(a,b){b=r[b];return Math.round(f.px(a,"border"+b.Left+"Width")+f.px(a,"border"+b.Right+"Width")+f.px(a,"margin"+b.Left)+f.px(a,"margin"+b.Right)+f.px(a,"padding"+b.Left)+f.px(a,"padding"+b.Right))}function N(a,b){T=a.dirty=true;b&&B.layouts2.scheduleAdjust()}function C(a,b,c){if(a.style[b]!==c){a.style[b]=c;return true}else return false}function ba(a,b,c){b=r[a];var h=r[a^1],g=b.measures,l=b.config.length,p=h.config.length;
if(T||L){if(c&&typeof b.minSize=="undefined"){b.minSize=f.px(c,"min"+b.Size);if(b.minSize>0)b.minSize-=V(c,a)}g=g.slice();if(g.length==5){g[0]=g[0].slice();g[1]=g[1].slice()}var s=[],d=[],k=0,u=0,j,n;for(j=0;j<l;++j){var q=0,o=0,z=b.config[j][2],i=true;for(n=0;n<p;++n){var e=b.getItem(j,n);if(e){if(!e.w||a==0&&e.dirty){var m=$("#"+e.id),v=m.get(0);if(v!=e.w){e.w=v;m.find("img").add(m.filter("img")).bind("load",{item:e},function(ca){N(ca.data.item,true)});e.w.style[b.left]=e.w.style[h.left]="-1000000px"}}if(!K&&
e.w.style.position!="absolute"){e.w.style.position="absolute";e.w.style.visibility="hidden";if(!e.w.wtResize&&!f.isIE){e.w.style.boxSizing="border-box";if(m=f.cssPrefix("BoxSizing"))e.w.style[m+"BoxSizing"]="border-box"}}if(!e.ps)e.ps=[];if(!e.ms)e.ms=[];if(!e.size)e.size=[];if(!e.psize)e.psize=[];if(!e.fs)e.fs=[];if($(e.w).hasClass("Wt-hidden"))e.ps[a]=e.ms[a]=0;else{m=!e.set;if(!e.set)e.set=[false,false];if(e.w){if(f.isIE)e.w.style.visibility="";console.log("measure "+a+" "+e.id+": "+e.ps[0]+","+
e.ps[1]);if(e.dirty||L){v=w(e.w,a);if(v>z)z=v;e.ms[a]=v;if(!e.set[a])if(a==0||!m){m=f.pxself(e.w,b.size);e.fs[a]=m?m+G(e.w,a):0}else{m=Math.round(f.px(e.w,b.size));e.fs[a]=m>Math.max(V(e.w,a),v)?m+G(e.w,a):0}m=e.fs[a];if(e.layout){if(m==0)m=e.ps[a]}else{if(e.wasLayout){e.wasLayout=false;e.set=[false,false];e.ps-=0.1;e.w.wtResize&&e.w.wtResize(e.w,-1,-1,true);C(e.w,r[1].size,"")}v=E(e.w,a);var X=typeof e.ps[a]!=="undefined"&&b.config[j][0]>0&&e.set[a];m=e.set[a]&&v>=e.psize[a]-4&&v<=e.psize[a]+4||
X?Math.max(m,e.ps[a]):Math.max(m,v)}e.ps[a]=m;if(!e.span||e.span[a]==1){if(m>q)q=m}else if(m>o)o=m}else if(!e.span||e.span[a]==1){if(e.ps[a]>q)q=e.ps[a];if(e.ms[a]>z)z=e.ms[a]}else if(e.ps[a]>o)o=e.ps[a];console.log(" ->"+e.id+": "+e.ps[0]+","+e.ps[1]);if(e.w.style.display!=="none"||f.hasTag(e.w,"TEXTAREA")&&e.w.wtResize)i=false}}}}if(i)z=q=-1;else{if(q==0)q=o;if(z>q)q=z}s[j]=q;d[j]=z;if(z>-1){k+=q;u+=z}}h=0;m=true;p=false;for(j=0;j<l;++j)if(d[j]>-1){if(m){h+=b.margins[1];m=false}else{h+=b.margins[0];
if(p)h+=4}p=b.config[j][1]!==0}m||(h+=b.margins[2]);k+=h;u+=h;console.log("measured "+D+": "+a+" ps "+s);b.measures=[s,d,k,u,h];if(L||g[2]!=b.measures[2])O.updateSizeInParent(a);c&&b.minSize==0&&g[3]!=b.measures[3]&&c.parentNode.className!="Wt-domRoot"&&C(c,"min"+b.Size,b.measures[3]+"px")&&O.ancestor&&O.ancestor.setContentsDirty(c);c&&a==0&&c&&f.hasTag(c,"TD")&&C(c,b.size,b.measures[2]+"px")}}function da(a,b,c){a=r[a];if(U)c=-c;if(a.config[b][0]>0&&a.config[b+1][0]==0){++b;c=-c}a.fixedSize[b]=a.sizes[b]+
c;B.layouts2.scheduleAdjust()}function ea(a,b,c){var h=b.di,g=r[a],l=r[a^1],p,s=f.getElement(D),d;for(d=h-1;d>=0;--d)if(g.sizes[d]>=0){p=-(g.sizes[d]-g.measures[1][d]);break}h=g.sizes[h]-g.measures[1][h];if(U){var k=p;p=-h;h=-k}new f.SizeHandle(f,g.resizeDir,f.pxself(b,g.size),f.pxself(b,l.size),p,h,g.resizerClass,function(u){da(a,d,u)},b,s,c,0,0)}function fa(a,b){var c=r[a],h=r[a^1],g=c.measures,l=0,p=false,s=false,d=false,k=Y?b.parentNode:null;if(c.maxSize===0)if(k){var u=f.css(k,"position");if(u===
"absolute")l=f.pxself(k,c.size);if(l===0){if(!c.initialized){if(a===0&&(u==="absolute"||u==="fixed")){k.style.display="none";l=k.clientWidth;k.style.display=""}l=a?k.clientHeight:k.clientWidth;p=true;if(a==0&&l==0&&f.isIElt9){l=k.offsetWidth;p=false}var j;if((f.hasTag(k,"TD")||f.hasTag(k,"TH"))&&!(f.isIE&&!f.isIElt9)){d=0;j=1}else{d=c.minSize?c.minSize:g[3];j=0}if(f.isIElt9&&l==j||l==d+I(k,a)){console.log("switching to managed container size "+a+" "+D);c.maxSize=999999}}if(l===0&&c.maxSize===0){l=
a?k.clientHeight:k.clientWidth;p=true}}}else{l=f.pxself(b,c.size);s=true}var n=0;if(k&&k.wtGetPS&&a==1)n=k.wtGetPS(k,b,a,0);d=g[2];if(d<c.minSize)d=c.minSize;if(c.maxSize)if(d+n<c.maxSize){C(k,c.size,d+n+V(k,a)+"px")&&B.layouts2.remeasure();l=d+n;d=s=true}else{l=c.maxSize;p=false}c.cSize=l;if(a==1&&k&&k.wtResize){j=h.cSize;d=c.cSize;k.wtResize(k,Math.round(j),Math.round(d),true)}l-=n;if(!s){s=0;if(typeof c.cPadding==="undefined"){s=p?I(k,a):V(k,a);c.cPadding=s}else s=c.cPadding;l-=s}c.initialized=
true;console.log("apply "+D+": "+a+" ps "+g[0]+" cSize "+l);if(!(k&&l<=0)){if(l<g[3]-n)l=g[3]-n;p=[];k=c.config.length;s=h.config.length;for(d=0;d<k;++d)c.stretched[d]=false;if(l>=g[3]-n){n=l-g[4];j=[];var q=[0,0],o=[0,0],z=0;for(d=0;d<k;++d)if(g[1][d]>-1){var i=-1;if(typeof c.fixedSize[d]!=="undefined"&&(d+1==k||g[1][d+1]>-1))i=c.fixedSize[d];else if(c.config[d][1]!==0&&c.config[d][1][0]>=0){i=c.config[d][1][0];if(c.config[d][1][1])i=(l-g[4])*i/100}if(i>=0){j[d]=-1;p[d]=i;n-=p[d]}else{if(c.config[d][0]>
0){i=1;j[d]=c.config[d][0];z+=j[d]}else{i=0;j[d]=0}q[i]+=g[1][d];o[i]+=g[0][d];p[d]=g[0][d]}}else j[d]=-2;if(z==0){for(d=0;d<k;++d)if(j[d]==0){j[d]=1;++z}o[1]=o[0];q[1]=q[0];o[0]=0;q[0]=0}if(n>o[0]+q[1]){n-=o[0];if(n>o[1]){if(c.fitSize){n-=o[1];n=n/z;for(d=0;d<k;++d)if(j[d]>0){p[d]+=Math.round(j[d]*n);c.stretched[d]=true}}}else{i=1;if(n<q[i])n=q[i];n=o[i]-q[i]>0?(n-q[i])/(o[i]-q[i]):0;for(d=0;d<k;++d)if(j[d]>0){q=g[0][d]-g[1][d];p[d]=g[1][d]+Math.round(q*n)}}}else{for(d=0;d<k;++d)if(j[d]>0)p[d]=g[1][d];
n-=q[1];i=0;if(n<q[i])n=q[i];n=o[i]-q[i]>0?(n-q[i])/(o[i]-q[i]):0;for(d=0;d<k;++d)if(j[d]==0){q=g[0][d]-g[1][d];p[d]=g[1][d]+Math.round(q*n)}}}else p=g[1];c.sizes=p;console.log(" -> targetSize: "+p);g=0;n=true;o=false;for(d=0;d<k;++d)if(p[d]>-1){if(q=o){j=D+"-rs"+a+"-"+d;o=f.getElement(j);if(!o){o=document.createElement("div");o.setAttribute("id",j);o.di=d;o.style.position="absolute";o.style[h.left]=h.margins[1]+"px";o.style[c.size]=c.margins[0]+"px";if(h.cSize)o.style[h.size]=h.cSize-h.margins[2]-
h.margins[1]+"px";o.className=c.handleClass;b.insertBefore(o,b.firstChild);o.onmousedown=o.ontouchstart=function(X){ea(a,this,X||window.event)}}g+=2;C(o,c.left,g+"px");g+=2}o=c.config[d][1]!==0;if(n){g+=c.margins[1];n=false}else g+=c.margins[0];for(z=0;z<s;++z)if((i=c.getItem(d,z))&&i.w){j=i.w;u=p[d];if(i.span){var e,m=o;for(e=1;e<i.span[a];++e){if(d+e>=p.length)break;if(m)u+=4;m=c.config[d+e][1]!==0;u+=c.margins[0];u+=p[d+e]}}var v;C(j,"visibility","");m=i.align>>c.alignBits&15;e=i.ps[a];if(u<e)m=
0;if(m){switch(m){case 1:v=g;break;case 4:v=g+(u-e)/2;break;case 2:v=g+(u-e);break}e-=G(i.w,a);if(i.layout){C(j,c.size,e+"px")&&N(i);i.set[a]=true}else if(u>=e&&i.set[a]){C(j,c.size,e+"px")&&N(i);i.set[a]=false}i.size[a]=e;i.psize[a]=e}else{v=G(i.w,a);m=Math.max(0,u-v);v=false;if(f.isIE&&f.hasTag(j,"BUTTON"))v=true;if(v||u!=e||i.layout){C(j,c.size,m+"px")&&N(i);i.set[a]=true}else if(i.fs[a])a==0&&C(j,c.size,i.fs[a]+"px");else{C(j,c.size,"")&&N(i);i.set[a]=false}v=g;i.size[a]=m;i.psize[a]=u}if(K)if(q){C(j,
c.left,"4px");u=f.css(j,"position");if(u!=="absolute")j.style.position="relative"}else C(j,c.left,"0px");else C(j,c.left,v+"px");if(a==1){if(j.wtResize)j.wtResize(j,i.set[0]?Math.round(i.size[0]):-1,i.set[1]?Math.round(i.size[1]):-1,true);i.dirty=false}}g+=p[d]}$(b).children("."+h.handleClass).css(c.size,l-c.margins[2]-c.margins[1]+"px")}}var f=B.WT;this.ancestor=null;this.descendants=[];var O=this,H=y,T=false,L=true,Y=false,W=null,P=null,Z=false,Q=[],aa=false,U=$(document.body).hasClass("Wt-rtl"),
r=[{initialized:false,config:H.cols,margins:A,maxSize:t,measures:[],sizes:[],stretched:[],fixedSize:[],Left:U?"Right":"Left",left:U?"right":"left",Right:U?"Left":"Right",Size:"Width",size:"width",alignBits:0,getItem:function(a,b){return H.items[b*r[0].config.length+a]},handleClass:"Wt-vrh2",resizeDir:"h",resizerClass:"Wt-hsh2",fitSize:M},{initialized:false,config:H.rows,margins:x,maxSize:F,measures:[],sizes:[],stretched:[],fixedSize:[],Left:"Top",left:"top",Right:"Bottom",Size:"Height",size:"height",
alignBits:4,getItem:function(a,b){return H.items[a*r[0].config.length+b]},handleClass:"Wt-hrh2",resizeDir:"v",resizerClass:"Wt-vsh2",fitSize:R}];jQuery.data(document.getElementById(D),"layout",this);this.updateSizeInParent=function(a){if(W){var b=r[a],c=b.measures[2];if(b.maxSize>0)c=Math.min(b.maxSize,c);if(aa){b=f.getElement(D);if(!b)return;for(var h=b,g=h.parentNode;;){if(g.wtGetPS)c=g.wtGetPS(g,h,a,c);c+=S(g,a);if(g==P)break;if(g==b.parentNode&&!g.lh&&g.offsetHeight>c)c=g.offsetHeight;h=g;g=h.parentNode}}else c+=
Q[a];W.setChildSize(P,a,c)}};this.setConfig=function(a){var b=H;H=a;r[0].config=H.cols;r[1].config=H.rows;r[0].stretched=[];r[1].stretched=[];var c;a=0;for(c=b.items.length;a<c;++a){var h=b.items[a];if(h){if(h.set){h.set[0]&&C(h.w,r[0].size,"");h.set[1]&&C(h.w,r[1].size,"")}if(h.layout){O.setChildSize(h.w,0,h.ps[0]);O.setChildSize(h.w,1,h.ps[1])}}}L=true;B.layouts2.scheduleAdjust()};this.getId=function(){return D};this.setItemsDirty=function(a){var b,c,h=r[0].config.length;b=0;for(c=a.length;b<c;++b){var g=
H.items[a[b][0]*h+a[b][1]];g.dirty=true;if(g.layout){g.layout=false;g.wasLayout=true;B.layouts2.setChildLayoutsDirty(O,g.w)}}T=true};this.setDirty=function(){L=true};this.setChildSize=function(a,b,c){var h=r[0].config.length,g=r[b],l,p;l=0;for(p=H.items.length;l<p;++l){var s=H.items[l];if(s&&s.id==a.id){a=b===0?l%h:l/h;if(s.align>>g.alignBits&15||!g.stretched[a]){if(!s.ps)s.ps=[];s.ps[b]=c}s.layout=true;N(s);break}}};this.measure=function(a){var b=f.getElement(D);if(b)if(!f.isHidden(b)){if(!Z){Z=
true;if(Y=J==null){var c=b;c=c.parentNode;for(Q=[0,0];;){Q[0]+=S(c,0);Q[1]+=S(c,1);if(c.wtGetPS)aa=true;var h=jQuery.data(c.parentNode,"layout");if(h){W=h;P=c;break}c=c;c=c.parentNode;if(c.childNodes.length!=1&&!c.wtGetPS)break}}else{W=jQuery.data(document.getElementById(J),"layout");P=b;Q[0]=S(P,0);Q[1]=S(P,1)}}if(T||L)ba(a,b,Y?b.parentNode:null);if(a==1)T=L=false}};this.setMaxSize=function(a,b){r[0].maxSize=a;r[1].maxSize=b};this.apply=function(a){var b=f.getElement(D);if(!b)return false;if(f.isHidden(b))return true;
fa(a,b);return true};this.contains=function(a){var b=f.getElement(D);a=f.getElement(a.getId());return b&&a?f.contains(b,a):false};this.WT=f});WT_DECLARE_WT_MEMBER(2,JavaScriptPrototype,"StdLayout2.prototype.initResize",function(){this.resizeInitialized=true});
WT_DECLARE_APP_MEMBER(1,JavaScriptObject,"layouts2",new (function(){var B=[],D=false,J=this,M=false;this.find=function(t){return jQuery.data(document.getElementById(t),"layout")};this.setDirty=function(t){(t=jQuery.data(t,"layout"))&&t.setDirty()};this.setChildLayoutsDirty=function(t,F){var A,x;A=0;for(x=t.descendants.length;A<x;++A){var y=t.descendants[A];if(F){var E=t.WT.getElement(y.getId());if(E&&!t.WT.contains(F,E))continue}y.setDirty()}};this.add=function(t){function F(A,x){var y,E;y=0;for(E=
A.length;y<E;++y){var w=A[y];if(w.getId()==x.getId()){A[y]=x;x.descendants=w.descendants;return}else if(w.contains(x)){F(w.descendants,x);return}else if(x.contains(w)){x.descendants.push(w);A.splice(y,1);--y;--E}}A.push(x)}F(B,t);J.scheduleAdjust()};var R=false,K=false;this.scheduleAdjust=function(){if(!R){R=true;setTimeout(function(){J.adjust()},0)}};this.adjust=function(t,F){function A(y,E){var w,G;w=0;for(G=y.length;w<G;++w){var I=y[w];A(I.descendants,E);E==1&&M&&I.setDirty();I.measure(E)}}function x(y,
E){var w,G;w=0;for(G=y.length;w<G;++w){var I=y[w];if(I.apply(E))x(I.descendants,E);else{y.splice(w,1);--w;--G}}}if(t){(t=this.find(t))&&t.setItemsDirty(F);J.scheduleAdjust()}else{R=false;if(!D){D=true;K=false;A(B,0);x(B,0);A(B,1);x(B,1);if(K){A(B,0);x(B,0);A(B,1);x(B,1)}M=K=D=false}}};this.updateConfig=function(t,F){(t=this.find(t))&&t.setConfig(F)};this.remeasure=function(){K=true};window.onresize=function(){M=true;J.scheduleAdjust()};window.onshow=function(){M=true;J.adjust()}}));
