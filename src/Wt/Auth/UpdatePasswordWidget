// This may look like C code, but it's really -*- C++ -*-
/*
 * Copyright (C) 2011 Emweb bvba, Kessel-Lo, Belgium.
 *
 * See the LICENSE file for terms of use.
 */
#ifndef WT_AUTH_UPDATE_PASSWORD_WIDGET_H_
#define WT_AUTH_UPDATE_PASSWORD_WIDGET_H_

#include <Wt/WTemplate>

namespace Wt {
  namespace Auth {

class AbstractPasswordAuth;
class ChoosePasswordFields;
class EnterPasswordFields;

/*! \class UpdatePasswordWidget Auth/UpdatePasswordWidget
 *  \brief A widget which allows a user to choose a new password.
 *
 * This widget lets a user choose a new password.
 *
 * The widget renders the <tt>"Wt.Auth.template.update-password"</tt>
 * template. Optionally, it asks for the current password, as well as
 * a new password.
 *
 * \sa AuthWidget::createUpdatePasswordView()
 *
 * \ingroup auth
 */
class WT_API UpdatePasswordWidget : public WTemplate
{
public:
  /*! \brief Constructor.
   *
   * If \p promptPassword is \c true, the user also has to enter his
   * current password.
   */
  UpdatePasswordWidget(const User& user, const AbstractPasswordAuth& auth,
		       bool promptPassword, WContainerWidget *parent = 0);

private:
  const User& user_;
  const AbstractPasswordAuth& passwordAuth_;
  bool promptPassword_;

  ChoosePasswordFields *choosePasswordFields_;
  EnterPasswordFields *enterPasswordFields_;

  bool validate();
  void doUpdate();
  void close();
};

  }
}

#endif // WT_AUTH_UPDATE_PASSWORD_WIDGET_H_
